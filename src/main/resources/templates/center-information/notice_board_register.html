<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org" xmlns:script="http://www.w3.org/1999/xhtml">

<head>
    <title>공지사항 등록</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />

    <link rel="stylesheet" href="/src/main/resources/static/css/center_guide.css" th:href="@{/css/center_guide.css}" />
    <link rel="stylesheet" href="/src/main/resources/static/css/frame.css" th:href="@{/css/frame.css}">

    <!-- 채용공고 등록 게시판 CSS 디자인 -->
    <link rel="stylesheet" href="/src/main/resources/static/css/notice_board.css" th:href="@{/css/notice_board.css}">

</head>

<body class="is-preload">
    <div id="page-wrapper">

        <!-- Header -->
        <header id="header">
            <!--네비 div-->
            <div th:replace="layout/layout :: nav" />

        </header>

        <!-- Main -->
        <div id="mainWrap">
            <section id="main">
                <div class="container">
                    <div class="row">
                        <div class="col-3">
                            <div class="sidebar">
                                <div class="menu2">
                                    <div id="bar">
                                        <h2>센터안내</h2>
                                        <ul id="menu_bar">
                                            <li id="menu_con1">
                                                <h4>센터정보</h4>
                                                <ul id="sb_detail">
                                                    <li><a href="#"
                                                            th:href="@{/center-information/center_introduction}">센터소개</a>
                                                    </li>
                                                    <li><a href="#"
                                                            th:href="@{/center-information/main_business}">주요업무내용</a>
                                                    </li>
                                                    <li><a href="#"
                                                            th:href="@{/center-information/notice_board}">공지사항</a></li>
                                                </ul>
                                            </li>
                                            <!-- <li id="menu_con2"><h4>직업 정보</h4>
                                            <ul id="sb_detail">
                                                <li><a href="#">직업 정보 조회</a></li>
                                                <li><a href="#">직업 사전</a></li>
                                            </ul>
                                        </li>
                                        <li id="menu_con3"><h4>상담 정보</h4>
                                            <ul id="sb_detail">
                                                <li><a href="#">상담 신청</a></li>
                                                <li><a href="#">상담 내역</a></li>
                                            </ul>
                                        </li> -->
                                        </ul>
                                    </div> <!-- bar -->
                                </div> <!-- menu -->
                            </div>
                        </div>


                        <!-- Content -->
                        <div class="notice_board_content">
                            <div class="register_head">
                                <div class="register_head_txt">
                                    공지사항 게시판
                                </div>
                            </div>

                            <div class="content">

                                <form th:action="@{/center-information/notice_board_register}" th:method="post">

                                    <div class="register_title_wrap">
                                        <label>제목</label>
                                        <input type="text" class="register_title_input" name="title"
                                            placeholder="제목을 입력하세요">
                                    </div>

                                    <div class="register_cont_wrap">
                                        <label>내용</label>
                                        <input type="text" class="register_cont_input" rows="5" name="content"
                                            placeholder="내용을 입력하세요"></input>
                                    </div>


                                    <div class="form-group fileForm">
                                        <div class="custom-file">
                                            <input type="file" class="custom-file-input files" id="fileInput" multiple>
                                            <label class="custom-file-label" data-browse="Browse"></label>
                                        </div>
                                    </div>



                                    <div class="submit_btn">
                                        <button type="submit">등록</button>
                                    </div>
                                </form>

                            </div>
                        </div>
                        <!-- End Content -->



                    </div>
                </div>
            </section>


            <!--footer -->
            <footer th:replace="layout/layout :: footer" />
        </div>
    </div>
    </div>
    </section>




    </div>

    <!-- Scripts -->
    <script src="/js/jquery-3.5.1.min.js"></script>

    <!-- script for upload -->
    <script>
        $(document).ready(function (e) {

            //var regex = new RegExp("(.*?)\.(exe|sh|zip|alz|tiff)$"); // 파일 업로드 시 이미지 파일만 업로드 할 수 있도록
            var maxSize = 10485760; //10MB

            function checkExtension(fileName, fileSize) {

                if (fileSize >= maxSize) {
                    alert("파일 사이즈 초과");
                    return false;
                }

                // if (regex.test(fileName)) { // 파일 확장자 검사
                //     alert("해당 종류의 파일은 업로드할 수 없습니다.");
                //     return false;
                // }
                return true;
            }

            $(".custom-file-input").on("change", function () {

                var fileName = $(this).val().split("\\").pop();
                $(this).siblings(".custom-file-label").addClass("selected").html(fileName);

                var formData = new FormData();

                var inputFile = $(this);

                var files = inputFile[0].files;

                var appended = false;

                for (var i = 0; i < files.length; i++) {

                    if (!checkExtension(files[i].name, files[i].size)) {
                        return false;
                    }

                    console.log(files[i]);
                    formData.append("uploadFiles", files[i]);
                    appended = true;
                }

                //upload를 하지 않는다.
                if (!appended) {
                    return;
                }

                for (var value of formData.values()) {
                    console.log(value);
                }

                //실제 업로드 부분
                //upload ajax
                $.ajax({
                    url: '/uploadAjax',
                    processData: false,
                    contentType: false,
                    data: formData,
                    type: 'POST',
                    dataType: 'json',
                    success: function (result) {
                        console.log(result);
                        showResult(result);
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        console.log(textStatus);
                    }
                }); //$.ajax
            }); //end change event


            // function showResult(uploadResultArr) {
            //
            //     var uploadUL = $(".uploadResult ul");
            //
            //     var str = "";
            //
            //     $(uploadResultArr).each(function (i, obj) {
            //
            //         str += "<li data-name='" + obj.fileName + "' data-path='" + obj.folderPath +
            //             "' data-uuid='" + obj.uuid + "'>";
            //         str + " <div>";
            //         str += "<button type='button' data-file=\'" + obj.imageURL + "\' "
            //         str += "class='btn-warning btn-sm'>X</button><br>";
            //         str += "<img src='/display?fileName=" + obj.thumbnailURL + "'>";
            //         str += "</div>";
            //         str + "</li>";
            //     });
            //
            //     uploadUL.append(str);
            // }

            // $(".uploadResult ").on("click", "li button", function (e) {
            //
            //     console.log("delete file");
            //
            //     var targetFile = $(this).data("file");
            //
            //     var targetLi = $(this).closest("li");
            //
            //     $.ajax({    // 파일 삭제
            //         url: '/removeFile',
            //         data: {
            //             fileName: targetFile
            //         },
            //         dataType: 'text',
            //         type: 'POST',
            //         success: function (result) {
            //             alert(result);
            //
            //             targetLi.remove();
            //         }
            //     }); //$.ajax
            // });


            //prevent submit
            // $(".btn-primary").on("click", function (e) {
            //     e.preventDefault();
            //
            //     var str = "";
            //
            //     $(".uploadResult li").each(function (i, obj) {
            //         var target = $(obj);
            //
            //         str += "<input type='hidden' name='imageDTOList[" + i +
            //             "].imgName' value='" + target.data('name') + "'>";
            //
            //         str += "<input type='hidden' name='imageDTOList[" + i +
            //             "].path' value='" + target.data('path') + "'>";
            //
            //         str += "<input type='hidden' name='imageDTOList[" + i +
            //             "].uuid' value='" + target.data('uuid') + "'>";
            //
            //     });
            //
            //     //태그들이 추가된 것을 확인한 후에 comment를 제거
            //     $(".box").html(str);
            //
            //     $("form").submit();
            //
            // });


        }); //document ready
    </script>


    <!-- <script src="assets/js/jquery.min.js"></script>
<script src="assets/js/jquery.dropotron.min.js"></script>
<script src="assets/js/jquery.scrolly.min.js"></script>
<script src="assets/js/browser.min.js"></script>
<script src="assets/js/breakpoints.min.js"></script>
<script src="assets/js/util.js"></script> -->
    <!-- <script src="assets/js/main.js"></script> -->
</body>

</html>